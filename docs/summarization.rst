Summarization
===================================

In summarization we have two sequences. A larger sequence is represented by a smaller sequence aka summarized.

Let's take a look at how a simple summarization dataset might look like.

.. raw:: html

    <style type="text/css">
    .tg  {border-collapse:collapse;border-spacing:0;}
    .tg td{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
    overflow:hidden;padding:10px 5px;word-break:normal;}
    .tg th{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
    font-weight:normal;overflow:hidden;padding:10px 5px;word-break:normal;}
    .tg .tg-0pky{border-color:inherit;text-align:left;vertical-align:top}
    </style>
    <table class="tg">
    <thead>
    <tr>
        <th class="tg-0pky"><span style="font-weight:bold">document</span></th>
        <th class="tg-0pky"><span style="font-weight:bold">summary</span></th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td class="tg-0pky">Recent reports have linked some France-based<br><br>players with returns to Wales. "I've always felt -<br>and this is with my rugby hat on now; this is not<br>region or WRU - I'd rather spend that money on<br>keeping players in Wales," said Davies. The WRU<br>provides £2m to the fund and £1.3m comes from the<br>regions. Former Wales and British and Irish Lions<br>fly-half Davies became WRU chairman on Tuesday 21<br>October, succeeding deposed David Pickering<br>following governing body elections. He is now<br>serving a notice period to leave his role as<br>Newport Gwent Dragons chief executive after being<br>voted on to the WRU board in September. Davies was<br>among the leading figures among Dragons, Ospreys,<br>Scarlets and Cardiff Blues officials who were<br>embroiled in a protracted dispute with the WRU<br>that ended in a £60m deal in August this year. In<br>the wake of that deal being done, Davies said the<br>£3.3m should be spent on ensuring current Wales-<br>based stars remain there. In recent weeks, Racing<br>Metro flanker Dan Lydiate was linked with<br>returning to Wales. Likewise the Paris club's<br>scrum-half Mike Phillips and centre Jamie Roberts<br>were also touted for possible returns. Wales coach<br>Warren Gatland has said: "We haven't instigated<br>contact with the players. "But we are aware that<br>one or two of them are keen to return to Wales<br>sooner rather than later." Speaking to Scrum V on<br>BBC Radio Wales, Davies re-iterated his stance,<br>saying keeping players such as Scarlets full-back<br>Liam Williams and Ospreys flanker Justin Tipuric<br>in Wales should take precedence. "It's obviously a<br>limited amount of money [available]. The union are<br>contributing 60% of that contract and the regions<br>are putting £1.3m in. "So it's a total pot of just<br>over £3m and if you look at the sorts of salaries<br>that the... guys... have been tempted to go<br>overseas for [are] significant amounts of money.<br>"So if we were to bring the players back, we'd<br>probably get five or six players. "And I've always<br>felt - and this is with my rugby hat on now; this<br>is not region or WRU - I'd rather spend that money<br>on keeping players in Wales. "There are players<br>coming out of contract, perhaps in the next year<br>or so… you're looking at your Liam Williams' of<br>the world; Justin Tipuric for example - we need to<br>keep these guys in Wales. "We actually want them<br>there. They are the ones who are going to impress<br>the young kids, for example. "They are the sort of<br>heroes that our young kids want to emulate. "So I<br>would start off [by saying] with the limited pot<br>of money, we have to retain players in Wales.<br>"Now, if that can be done and there's some spare<br>monies available at the end, yes, let's look to<br>bring players back. "But it's a cruel world, isn't<br>it? "It's fine to take the buck and go, but great<br>if you can get them back as well, provided there's<br>enough money." British and Irish Lions centre<br>Roberts has insisted he will see out his Racing<br>Metro contract. He and Phillips also earlier<br>dismissed the idea of leaving Paris. Roberts also<br>admitted being hurt by comments in French<br>Newspaper L'Equipe attributed to Racing Coach<br>Laurent Labit questioning their effectiveness.<br>Centre Roberts and flanker Lydiate joined Racing<br>ahead of the 2013-14 season while scrum-half<br>Phillips moved there in December 2013 after being<br>dismissed for disciplinary reasons by former club<br>Bayonne.</td>
        <td class="tg-0pky"><span style="font-weight:400;font-style:normal">New Welsh Rugby Union chairman Gareth Davies</span><br><span style="font-weight:400;font-style:normal">believes a joint £3.3m WRU-regions fund should be</span><br><span style="font-weight:400;font-style:normal">used to retain home-based talent such as Liam</span><br><span style="font-weight:400;font-style:normal">Williams, not bring back exiled stars.</span></td>
    </tr>
    <tr>
        <td class="tg-0pky"><span style="font-weight:400;font-style:normal">Army explosives experts were called out to deal</span><br><span style="font-weight:400;font-style:normal">with a suspect package at the offices on the</span><br><span style="font-weight:400;font-style:normal">Newtownards Road on Friday night. Roads were</span><br><span style="font-weight:400;font-style:normal">sealed off and traffic diverted as a controlled</span><br><span style="font-weight:400;font-style:normal">explosion was carried out. The premises, used by</span><br><span style="font-weight:400;font-style:normal">East Belfast MP Naomi Long, have been targeted a</span><br><span style="font-weight:400;font-style:normal">number of times. Most recently, petrol bomb</span><br><span style="font-weight:400;font-style:normal">attacks were carried out on the offices on</span><br><span style="font-weight:400;font-style:normal">consecutive nights in April and May. The attacks</span><br><span style="font-weight:400;font-style:normal">began following a Belfast City Council vote in</span><br><span style="font-weight:400;font-style:normal">December 2012 restricting the flying of the union</span><br><span style="font-weight:400;font-style:normal">flag at the City Hall. Condemning the latest hoax,</span><br><span style="font-weight:400;font-style:normal">Alliance MLA Chris Lyttle said: "It is a serious</span><br><span style="font-weight:400;font-style:normal">incident for the local area, it causes serious</span><br><span style="font-weight:400;font-style:normal">disruption, it puts people's lives at risk, it can</span><br><span style="font-weight:400;font-style:normal">prevent emergency services reaching the area.</span><br><span style="font-weight:400;font-style:normal">"Ultimately we need people with information to</span><br><span style="font-weight:400;font-style:normal">share that with the police in order for them to do</span><br><span style="font-weight:400;font-style:normal">their job and bring these people to justice."</span></td>
        <td class="tg-0pky"><span style="font-weight:400;font-style:normal">A suspicious package left outside an Alliance</span><br><span style="font-weight:400;font-style:normal">Party office in east Belfast has been declared a</span><br><span style="font-weight:400;font-style:normal">hoax.</span></td>
    </tr>
    <tr>
        <td class="tg-0pky"><span style="font-weight:400;font-style:normal">The warning begins at 22:00 GMT on Saturday and</span><br><span style="font-weight:400;font-style:normal">ends at 10:00 on Sunday. The ice could lead to</span><br><span style="font-weight:400;font-style:normal">difficult driving conditions on untreated roads</span><br><span style="font-weight:400;font-style:normal">and slippery conditions on pavements, the weather</span><br><span style="font-weight:400;font-style:normal">service warned. Only the southernmost counties and</span><br><span style="font-weight:400;font-style:normal">parts of the most westerly counties are expected</span><br><span style="font-weight:400;font-style:normal">to escape. Counties expected to be affected are</span><br><span style="font-weight:400;font-style:normal">Carmarthenshire, Powys, Ceredigion, Pembrokeshire,</span><br><span style="font-weight:400;font-style:normal">Denbighshire, Gwynedd, Wrexham, Conwy, Flintshire,</span><br><span style="font-weight:400;font-style:normal">Anglesey, Monmouthshire, Blaenau Gwent,</span><br><span style="font-weight:400;font-style:normal">Caerphilly, Merthyr Tydfil, Neath Port Talbot,</span><br><span style="font-weight:400;font-style:normal">Rhondda Cynon Taff and Torfaen</span></td>
        <td class="tg-0pky"><span style="font-weight:400;font-style:normal">The Met Office has issued a yellow weather warning</span><br><span style="font-weight:400;font-style:normal">for ice across most of Wales.</span></td>
    </tr>
    </tbody>
    </table>


Once you have the data in the format specified above, you are ready to train models using AutoNLP. Yes, it's that easy.

The first step would be login to AutoNLP:

.. code-block:: bash

   $ autonlp login --api-key YOUR_HUGGING_FACE_API_TOKEN

If you do not know your Hugging Face API token, please create an account on huggingface.co and you will find your api key in settings. 
Please do not share your api key with anyone!

Once you have logged in, you can create a new project:

.. code-block:: bash

    $ autonlp create_project --name summarization_model --language en --task summarization

During creation of project, you can choose the language using "--language" parameter.

The next step is to upload files. Here, column mapping is very important. The columns from original data are mapped to AutoNLP column names.
In the data above, the original columns are "document" and "summary". We do not need more columns for a summarization problem.

AutoNLP columns for summarization are:

- text
- target

The original columns, thus, need to be mapped to text and target. This is done in upload command. You also need to tell AutoNLP what kind of split you are uploading: train or valid.

.. code-block:: bash

    autonlp upload --project summarization_model --split train \
                --col_mapping document:text,summary:target \
                --files ~/datasets/train.csv


Similarly, upload the validation file:

.. code-block:: bash

    autonlp upload --project summarization_model --split valid \
                --col_mapping document:text,summary:target \
                --files ~/datasets/valid.csv


Please note that you can upload multiple files by separating the paths by a comma, however, the column names must be the same in each file.


Once you have uploaded the files successfully, you can start training by using the train command:

.. code-block:: bash

    $ autonlp train --project summarization_model


And that's it!

Your model will start training and you can monitor the training if you wish.
